ROTEIRO TÉCNICO - SISTEMA TOQUE GOURMET

1. INTRODUÇÃO
   - Projeto: Sistema de Gestão de Receitas Online "Toque Gourmet"
   - Descrição: Plataforma web completa para compartilhamento e gerenciamento de receitas culinárias
   - Linguagem: JavaScript ES6+ modular
   - Backend: Node.js com API RESTful (localhost:8080)
   - Arquitetura: Frontend SPA com roteamento client-side
   - Funcionalidades Principais: CRUD completo, sistema de avaliação, filtros avançados, autenticação

2. ESTRUTURA DO PROJETO
   ├── app.js                           # Lógica principal e autenticação
   ├── style.css                        # Estilos globais
   ├── index.html                       # Página principal com slider
   ├── allrecipes.html                  # Catálogo completo com filtros
   ├── recipe.html                      # Detalhes da receita com avaliação
   ├── formrecipe.html                  # Formulário de criação/edição
   ├── profile.html                     # Perfil do usuário
   └── src/
       ├── assets/
       │   ├── img/                    # Imagens e ícones
       │   └── pages/                  # Páginas de componentes
       ├── components/                  # Modais reutilizáveis
       │   ├── feedback.css            # CSS específico do modal de avaliação
       │   ├── login.html             # Modal de login
       │   ├── newaccount.html        # Modal de cadastro
       │   └── feedback.html          # Template do modal de avaliação
       └── js/                         # Módulos JavaScript
           ├── cards.js                # Sistema de cards de receitas
           ├── filters.js              # Sistema de filtros avançados
           ├── formrecipe.js           # Lógica do formulário
           ├── slide.js                # Slider da homepage
           ├── avaliacao.js            # Sistema de avaliação de receitas
           ├── criar-categorias.js    # Carrega categorias dinâmicas
           └── criar-cozinhas.js      # Carrega tipos de cozinha

3. FLUXO DE NAVEGAÇÃO
   index.html → [cards] → recipe.html?id=X
   index.html → "Veja Mais" → allrecipes.html
   index.html → [ícone perfil] → login modal → profile.html
   profile.html → "Cadastrar Receita" → formrecipe.html
   allrecipes.html → [busca/filtros] → resultados dinâmicos
   recipe.html → "Avalie" → [verifica login] → modal de avaliação → API

4. MÓDULO PRINCIPAL (app.js)
   - Funções de Autenticação:
     * abrirLogin() - Abre modal de login com verificação de usuário
     * abrirCadastro() - Abre modal de cadastro
     * cadastrarUsuario() - Registra novo usuário na API
     * carregarPerfil() - Carrega perfil do usuário com receitas

   - Gestão de Receitas:
     * buscarReceitasUsuario() - Busca receitas do usuário logado
     * buscarReceitasLocal() - Busca/filtro local para performance
     * exibirReceitasEmGrid() - Exibe receitas em grid responsivo

   - Utilitários:
     * addReloadButton() - Botão de recarregar página
     * addBackButton() - Botão de voltar com histórico

5. SISTEMA DE CARDS (cards.js)
   - criaCard(receita) - Cria card dinâmico com imagem e dados
   - initHome() - Inicializa homepage com slider
   - initAllRecipes() - Inicializa página todas receitas
   - initRecipeDetails() - Carrega detalhes da receita específica
   - fetchReceitas() - Busca receitas da API com tratamento de erro

6. SISTEMA DE FILTROS AVANÇADOS (filters.js)
   - capturarFiltros() - Captura seleções múltiplas de filtros
   - buscarPorFiltros() - Busca com múltiplos parâmetros na API
   - criarFiltroCategorias() - Filtros dinâmicos de categorias
   - criarFiltroAlergenos() - Filtros de alérgenos alimentares
   - executarBusca() - Busca textual com debounce (500ms)
   - carregarFiltrosSalvos() - Restaura filtros persistidos em localStorage
   - inicializarPaginaAllrecipes() - Setup inicial da página

7. SISTEMA DE AVALIAÇÃO (avaliacao.js) ⭐ NOVO
   - abrirFeedback() - Cria modal de avaliação com dialog HTML5
   - avaliarReceita() - Verifica login antes de permitir avaliação
   - enviarAvaliacao() - Envia avaliação para API (POST /v1/toque_gourmet/avaliacao)
   - Sistema de estrelas interativo com hover effects
   - Integração com sistema de login existente
   - Classes CSS únicas para evitar conflitos (.avaliacao-*)

8. FORMULÁRIO DE RECEITAS (formrecipe.js)
   - carregarDadosReceitaNoFormulario() - Carrega dados para edição
   - criarNovoStep() / criarNovoIngrediente() - Campos dinâmicos
   - validarFormulario() - Validação completa dos campos
   - coletarDadosFormulario() - Coleta dados para envio à API
   - cadastrarReceita() - POST nova receita com upload de imagem
   - atualizarReceita() - PUT receita existente
   - atualizarReceitaComImagem() - PUT com preservação de imagem
   - excluirReceita() - DELETE receita com confirmação
   - gerenciarPreviewImagem() - Preview de upload em tempo real

9. SLIDER HOMEPAGE (slide.js)
   - mostrarSlide(index) - Exibe slide específico
   - proximoSlide() / anteriorSlide() - Navegação entre slides
   - iniciarSlide() - Inicia rotação automática (5 segundos)
   - pauseSlide() - Pausa em hover do mouse

10. ENDPOINTS DA API
    // Autenticação
    POST /v1/toque_gourmet/usuario/login - Login de usuário
    POST /v1/toque_gourmet/usuario - Cadastro de novo usuário

    // Receitas
    GET /v1/toque_gourmet/receita - Todas as receitas
    GET /v1/toque_gourmet/receita/:id - Detalhes de uma receita
    GET /v1/toque_gourmet/receita/usuario/:id - Receitas do usuário
    POST /v1/toque_gourmet/receita/upload - Criar nova receita com imagem
    PUT /v1/toque_gourmet/receita/:id - Atualizar receita existente
    PUT /v1/toque_gourmet/receita/upload/:id - Atualizar com nova imagem
    DELETE /v1/toque_gourmet/receita/:id - Excluir receita

    // Avaliações ⭐ NOVO
    POST /v1/toque_gourmet/avaliacao - Enviar avaliação de receita
    Body: {
        "id_usuario": 1,
        "id_receita": 12,
        "nota": 3.0,
        "descricao": "Excelente receita!"
    }

    // Filtros e Busca
    GET /v1/toque_gourmet/receita/filtro - Filtragem avançada
    GET /v1/toque_gourmet/receita/nome/:nome - Busca por nome
    GET /v1/toque_gourmet/categoria - Lista de categorias
    GET /v1/toque_gourmet/cozinha - Lista de tipos de cozinha
    GET /v1/toque_gourmet/alergenos - Lista de alérgenos

11. GERENCIAMENTO DE ESTADO
    - localStorage:
      * usuarioLogado - Sessão do usuário (JSON completo)
      * recipeFilters - Filtros persistidos entre sessões

    - sessionStorage:
      * avaliarAposLogin - Flag para abrir avaliação após login

    - Estados globais:
      * receitasUsuario - Array de receitas do usuário logado
      * receitaIdEditando - ID em modo de edição
      * filtersAtivos - Filtros atualmente aplicados

    - URL Parameters:
      * ?id=X - ID da receita para visualização/edição/avaliação
      * ?usuario_id=X - ID para filtro por usuário específico

12. SISTEMA DE MODAIS
    - Login Modal (components/login.html)
      * Validação de email e senha
      * Integração com API de autenticação
      * Redirecionamento após login

    - Cadastro Modal (components/newaccount.html)
      * Validação de formulário
      * Criação de novo usuário
      * Feedback de sucesso/erro

    - Avaliação Modal (avaliacao.js + feedback.css) ⭐ NOVO
      * Modal HTML5 dialog nativo
      * Sistema de estrelas (1-5) interativo
      * Campo de texto para comentários
      * Verificação de usuário logado
      * Classes CSS únicas (.avaliacao-*)
      * Centralizado na tela com backdrop

13. FUNCIONALIDADES IMPLEMENTADAS
    ✅ Autenticação completa com login/cadastro
    ✅ CRUD completo de receitas com upload de imagem
    ✅ Sistema de busca textual com debounce
    ✅ Filtros múltiplos (tempo, dificuldade, categorias, alérgenos)
    ✅ Grid responsivo de cards com hover effects
    ✅ Slider automático na homepage
    ✅ Navegação com botões voltar/recarregar
    ✅ Preservação de imagem em atualizações
    ✅ Persistência de filtros entre sessões
    ✅ Sistema de avaliação de receitas ⭐ NOVO
    ✅ Perfil do usuário com estatísticas
    ✅ Validação client-side completa

14. ARQUITETURA DE COMPONENTES
    - Modular ES6+ com separação clara de responsabilidades
    - Event delegation para performance otimizada
    - Async/await para operações assíncronas
    - Manipulação avançada de DOM com createElement
    - URLSearchParams para roteamento client-side
    - CSS Modules com classes específicas para evitar conflitos
    - HTML5 Dialog API para modais modernos

15. VALIDAÇÃO E TRATAMENTO DE ERROS
    - Validação client-side de todos os formulários
    - Try/catch em requisições assíncronas
    - Mensagens de erro amigáveis e específicas
    - Loading states durante requisições
    - Tratamento de respostas da API (status codes)
    - Fallback para imagens não encontradas

16. PERFORMANCE E OTIMIZAÇÕES
    - Debounce em busca (500ms) para reduzir requisições
    - Cache de receitas em memória
    - Lazy loading de componentes
    - Mínimo de requisições à API
    - Event delegation para múltiplos elementos
    - CSS otimizado com classes específicas
    - Imagens com tratamento de erro

17. SEGURANÇA
    - Validação de inputs no frontend
    - Sanitização de dados antes de enviar à API
    - Verificação de autenticação em ações críticas
    - Tokens de sessão armazenados em localStorage
    - Prevenção de XSS em conteúdo dinâmico

18. RESPONSIVIDADE
    - Layout adaptável para desktop, tablet e mobile
    - Grid flexível que se ajusta ao tamanho da tela
    - Modal centralizado em todos os dispositivos
    - Touch-friendly para dispositivos móveis
    - Menu otimizado para diferentes telas

EXEMPLOS DE CÓDIGO PRINCIPAIS:

1. Sistema de Avaliação Completo:
```javascript
function abrirFeedback() {
    const modal = document.createElement('dialog');
    modal.className = 'avaliacao-modal';
    // Cria estrelas, input, botões
    modal.showModal();
    // Verifica login e envia para API
}
```

2. Modal com CSS Único:
```css
.avaliacao-modal {
    /* Estilos específicos sem conflitos */
}
.avaliacao-modal[open] {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
```

3. Verificação de Login Integrada:
```javascript
function avaliarReceita() {
    const usuarioLogado = localStorage.getItem('usuarioLogado');
    if (!usuarioLogado) {
        sessionStorage.setItem('avaliarAposLogin', 'true');
        window.abrirLogin();
    } else {
        abrirFeedback();
    }
}
```

PONTOS TÉCNICOS RELEVANTES PARA DESTACAR:
- Arquitetura modular com componentes reutilizáveis
- Sistema de avaliação integrado com autenticação
- CSS isolado para evitar conflitos globais
- HTML5 Dialog API para modais modernos
- Sistema de filtros complexo com persistência
- Upload de arquivos com FormData
- Gestão de estado robusta com localStorage
- Componentização com modais reutilizáveis
- Navegação client-side com URL parameters
- Performance otimizada com debounce e cache

DESAFIOS E SOLUÇÕES IMPLEMENTADAS:
- Conflito de estilos CSS → Classes específicas (.avaliacao-*)
- Modal centralização → HTML5 Dialog com transform
- Autenticação antes de avaliar → Integração com sistema existente
- Performance em busca → Debounce de 500ms
- Responsividade → Grid flexível e media queries
- Validação de dados → Sanitização e verificação client-side